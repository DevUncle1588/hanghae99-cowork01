<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

    <!-- CSS -->
    <link rel="stylesheet"  href="{{url_for('static', filename='css/default.css')}}"/>

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- font : google -->
    <link href="https://fonts.googleapis.com/css?family=Stylish&display=swap" rel="stylesheet">

    <title>J-GATI LIST PAGE</title>
</head>
<body>
    <div class="wrap">
        <div class="header">
            <div class="header_logo">
                <h2 class="logo">J-GATI</h2>
            </div>
            <div class="bar_menu">
                <button class="btn_basic open_write" type="button">RECRUIT</button>
            </div>
        </div>
        <div class="box_list">
            {% for write_info in contents %}
                <div class="list_item" onclick="open_view(this)">
                    <div class="item_cont">
                        <p class="item_text item_title">{{ write_info.title }}</p>
                    </div>
                    <div class="item_cont">
                        <p class="item_text flex3 item_date">{{ write_info.date }}</p>
                        <p class="item_text flex1 item_attendance">{{ write_info.attendance }}</p>
                    </div>
                    <div class="item_cont">
                        <p class="item_text item_place">{{ write_info.place }}</p>
                    </div>
                    <div class="item_cont">
                        <p class="item_comment item_comment">{{ write_info.content }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- 작성   -->
    <div class="modal hidden" id="write-modal">
        <div class="modal_bg"></div>
        <div class="modalBox">
            <div class="btn_delete">
                <button class="delete close_write" type="button">X</button>
            </div>
            <div class="modal_container">
                <span>제목</span>
                <input id="write_title" type="text" class="form_control">
                <span>일시</span>
                <input id="write_date" type="text" class="form_control">
                <span>장소</span>
                <input id="write_place" type="text" class="form_control">
                <span>인원</span>
                <input id="write_attend" type="text" class="form_control">
                <span>설명</span>
                <textarea id="write_content" type="text" class="form_desc"></textarea>
             </div>
            <button onclick="submit()" class="closeBtn" >작성</button>
        </div>
    </div>

    <!-- view _ 참가   -->
    <!-- <button class="btn_basic openBtn open_view">참가자</button> -->
    <div class="modal hidden" id="view_modal">
        <div class="modal_bg"></div>
        <div class="modalBox">
            <div class="btn_delete">
                <button class="delete close_view">X</button>
            </div>
            <div class="modal_container">
                <span>제목</span>
                <p id="modal_title">내용</p>
                <span>일시</span>
                <p id="modal_date">내용</p>
                <span>장소</span>
                <p id="modal_place">내용</p>
                <span>인원</span>
                <p id="modal_attendance">내용</p>
                <span>설명</span>
                <p id="modal_comment">내용</p>
            </div>
            <footer class="btn_container">
                <button>참가신청</button>
                <button>참가취소</button>
            </footer>
        </div>
    </div>

    <script>
        function submit(){
            /* ID, PW값 변수 지정 */
            let title = $('#write_title').val();
            let date = $('#write_date').val();
            let place = $('#write_place').val();
            let attendance = $('#write_attend').val();
            let content = $('#write_content').val();

            /* ID, PW ajax type:POST */
            $.ajax({
                type: "POST",
                url: "/memo",
                data: {'title_give':title, 'date_give':date, 'place_give':place, 'attendance_give':attendance, 'content_give':content},
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert(response['msg']);
                        window.location.href = "/list"
                    } else {
                        alert(response['msg'])
                    }
                }
            })
        }

        $('.open_write').click(function (){
            $("#write-modal").removeClass("hidden")
        });
        $('.close_write').click(function (){
            $("#write-modal").addClass("hidden")
        });

        function open_view(e){
            let title = $(e).find('.item_title').text();
            let place = $(e).find('.item_place').text();
            let attendance = $(e).find('.item_attendance').text();
            let date = $(e).find('.item_date').text();
            let comment = $(e).find('.item_comment').text();

            $("#modal_title").text(title);
            $("#modal_place").text(place);
            $("#modal_attendance").text(attendance);
            $("#modal_date").text(date);
            $("#modal_comment").text(comment);
            $("#view_modal").removeClass("hidden")
        }
        $('.close_view').click(function (){
            $("#view_modal").addClass("hidden")
        });
    </script>
</body>
</html>